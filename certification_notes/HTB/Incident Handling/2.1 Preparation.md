---
title: "Preparation 2"     
layout: default          
---

Of course, part of prep other than documentation readiness and readiness to handle incidents (tools and jump bags) is the protection itself
Not necessarily part of incident handling team

## DMARC
email protection against phishing, built on top of SPF and DKIM

## EDR Endpoint Hardening

endpoint devices (workstations, latops)

Some examples:
- Disable LLMNR/NetBIOS
	- Link-Local Multicast Name Resolution, is protcol based on DNS  used in Windows systems, being replcaed with mDNS
	- NetBIOS: **Network Basic Input/Output System**, neworking protocol for applications running on same LAN communicate (can spoof names using Respnonder for these systems)
- Implement LAPS and remove administrative privileges from regular users
	- Local adminstrator password solution, securely manages and rotates local admin passwords across domain-joined computers
- Disable or configure PowerShell in "ConstrainedLanguage" mode
	- safer subset of functionality
- Enable Attack Surface Reduction (ASR) rules if using Microsoft Defender
	- block actions oftern used by malware, such as office commands
- Implement whitelisting. We know this is nearly impossible to implement. Consider at least blocking execution from user-writable folders (Downloads, Desktop, AppData, etc.). These are the locations where exploits and malicious payloads will initially find themselves. Remember to also block script types such as .hta, .vbs, .cmd, .bat, .js, and similar. Please pay attention to [LOLBin](https://lolbas-project.github.io) files while implementing whitelisting. Do not overlook them; they are really used in the wild as initial access to bypass whitelisting.
- Utilize host-based firewalls. As a bare minimum, block workstation-to-workstation communication and block outbound traffic to LOLBins
- Deploy an EDR (endpoint detection and response) product. At this point in time, [AMSI](https://learn.microsoft.com/en-us/windows/win32/amsi/how-amsi-helps) provides great visibility into obfuscated scripts for antimalware products to inspect the content before it gets executed. It is highly recommended that you only choose products that integrate with AMSI.
- - **AMSI (Antimalware Scan Interface)** lets EDR tools inspect script content (e.g., PowerShell, JavaScript) **before it runs**, even if obfuscated.
- **Technology**: Defender for Endpoint, CrowdStrike Falcon, SentinelOne, etc. Ensure it supports **AMSI** to catch in-memory script-based attack
LOLBins are legitamate binaries but attackers repurpose for attacks
-> may go under whitelisting since they already exist, look for suspicous uses of it or EDR solutions
Dynamic Link Library (DLL) is ==a file containing code and data that can be shared and used by multiple programs simultaneously==

**Active Directory (AD)** is **Microsoft's centralized directory service** used for managing and securing **identities, devices, and access** across a network, particularly in enterprise environments.

**EEE 802.1X**, network accesss protocol, enforces authentication before a device can access network

